{
  "hash": "3df8cb93c6ee2a0941348408a8d196ac",
  "result": {
    "markdown": "---\ntitle: \"VIVIENDA EN ESPAÑA\"\ndescription: |\n  Vamos a analizar el mercado de la vivienda y comprarlo con su accesibilidad de los jóvenes \nauthor:   \n  - Joel Seguí\\n\n  - Saúl Gil\\n   \n  - Pedro Peñalver\ndate: 2023-12-20                           #--\ncategories: [Trabajo BigData, Vivienda]      #--\nimage: \"./imagenes/my_favicon.png\"\ntitle-block-banner: true #- {true, false, \"green\",\"#AA0000\"}\ntitle-block-banner-color: \"lightgrey\"    #-\"#FFFFFF\" \ntoc-depth: 3\nsmooth-scroll: true\nformat: \n  html:\n    #backgroundcolor: \"#F1F3F4\"\n    #embed-resources: true\n    link-external-newwindow: true\n    #css: ./assets/my_css_file.css   #- CUIDADO!!!!\ncode-tools: true\ncode-link: true\n---\n\n\n# Introducción \n\nEl objetivo de este trabajo es analizar la situación en la que se encuentran los jóvenes a la hora de acceder al mercado laboral. Para ello analizaremos diferentes métricas entre las que se encuentran: Evolución de los niveles de precios de la vivienda a nivel nacional y autonómico, comparación de esta con la de los salarios reales…\n\nDe esta manera constataremos las dificultades a alas que se enfrentan los jóvenes españoles para emanciparse. También extraeremos conclusiones sobre si es así en todo el país o si por el contrario hay diferencias según el área geográfica. \n\n# Datos del trabajo\n\n::: {.panel-tabset}\n\n# Datos\n\nVamos a utilizar datos de los paquetes `pxR` <i>(ine)</I>, `eurostat` además de proveedores de datos externos.\n\n# Código\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#Paquetes Preliminares\nlibrary(pxR)\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(rlist)\nlibrary(fs)\nlibrary(curl)\nlibrary(rio)\nlibrary(readxl)\nlibrary(downloader)\nlibrary(writexl)\n\n#-------------------Creamos una carpeta para guardar los datos------------------\n\ndir_create(\"./docs/datos\")\n\n#Descargamos los datos y los exportamos sin pulir: \n\n#---------------------Índice de Precios de Vivienda-----------------------------\n\nurl <- \"https://www.ine.es/jaxiT3/files/t/es/px/25171.px?nocab=1\"\naa <- read.px(url)\n\n#Lo convertimos a CSV para simplificar y creamos un dataframe\n\nwrite.csv(aa, file = \"data.csv\", sep = \",\")\nIPV <- read.csv(\"data.csv\")\nrm(list = ls()[!ls() %in% c(\"IPV\")])\n\n#Los guardamos sin arreglar\nwrite.csv(IPV,  file = \"./docs/datos/ipv.csv\")\n#-------------------------Compra-venta de vivienda------------------------------\n\nruta_xls <- \"https://apps.fomento.gob.es/BoletinOnline2/sedal/34010110.XLS\"\n\ndownload.file(ruta_xls, \"datos.xls\", mode = \"wb\")\n\nnombres_hojas <- c(\"2004,2005,2006,2007,2008\", \"2009,2010,2011,2012,2013\", \n                   \"2014,2015,2016,2017,2018\", \"2019,2020,2021,2022,2023\")\n# Leer todas las hojas en una lista\nfor (i in seq_along(nombres_hojas)) {\n  hoja <- nombres_hojas[i]\n  df <- readxl::read_excel(\"datos.xls\", sheet = i) \n  write.csv(df, file = paste0(hoja, \".csv\"), row.names = FALSE)}\n\n#Juntamos las cuatro sheets en una y después arreglaremos el desastre\ncompraventa_2004 <- read.csv(\"2004,2005,2006,2007,2008.csv\")\ncompraventa_2009 <- read.csv(\"2009,2010,2011,2012,2013.csv\")\ncompraventa_2014 <- read.csv(\"2014,2015,2016,2017,2018.csv\")\ncompraventa_2019 <- read.csv(\"2019,2020,2021,2022,2023.csv\")\n\ncv <- bind_cols(compraventa_2009,compraventa_2014)\ncv <- bind_cols(cv,compraventa_2019)\ncompraventa_2004 <- compraventa_2004[1:nrow(cv), ]\ncv <- bind_cols(cv,compraventa_2004)\n\n\ncv <- cv %>%\n  filter(row_number() %in% 6:72)\ncv <- cv %>%\n  filter(!row_number() %in% 2)\n\n#Los guardamos sin arreglar\nwrite.csv(cv,  file = \"./docs/datos/cv.csv\")\nrm(list = ls())\n\n\n#--------------------------Renta por edad y sexo--------------------------------\n\nurl3 <- \"https://www.ine.es/jaxiT3/files/t/es/px/9942.px?nocab=1\"\naa <- read.px(url3)\n\n#Lo convertimos a CSV para simplificar y creamos un dataframe\n\nwrite.csv(aa, file = \"data.csv\", sep = \",\")\nrenta_edad <- read.csv(\"data.csv\")\n\n#Los guardamos sin arreglar\nwrite.csv(renta_edad, file = \"./docs/datos/renta_edad.csv\")\n\nrm(list = ls())\n#---------------------------Renta por nacionalidad------------------------------\n\nurl4 <- \"https://www.ine.es/jaxiT3/files/t/es/px/9945.px?nocab=1\"\naa <- read.px(url4)\n\n#Lo convertimos a CSV para simplificar y creamos un dataframe\n\nwrite.csv(aa, file = \"data.csv\", sep = \",\")\nrenta_nacionalidad <- read.csv(\"data.csv\")\n\n#Los guardamos sin arreglar\nwrite.csv(renta_nacionalidad, file = \"./docs/datos/renta_nacionalidad.csv\")\n\nrm(list = ls())\n\n\n#---------------------Hogares por regimen de tenencia edad----------------------\n\nurl4 <- \"https://www.ine.es/jaxiT3/files/t/es/px/9994.px?nocab=1\"\naa <- read.px(url4)\n\n#Lo convertimos a CSV para simplificar y creamos un dataframe\n\nwrite.csv(aa, file = \"data.csv\", sep = \",\")\nvivienda_edad <- read.csv(\"data.csv\")\n\n#Los guardamos sin arreglar\nwrite.csv(vivienda_edad, file = \"./docs/datos/vivienda_datos.csv\")\n\nrm(list = ls())\n\n#Borramos archivos como las sheets separadas y otros datos\nfile.remove(\"2004,2005,2006,2007,2008.csv\", \"2009,2010,2011,2012,2013.csv\",\n            \"2014,2015,2016,2017,2018.csv\", \"2019,2020,2021,2022,2023.csv\", \n            \"compraventa.csv\", \"data.csv\", \"datos.xls\", \"./docs/datos/25171.px\",\n            \"./docs/datos/34010110.XLS\")\n#> [1]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE\n\n#----------------------Procedemos a limpiar los datos---------------------------\n\n#-------------Creamos una carpeta para guardar los datos pulidos----------------\n\ndir_create(\"./datos_pulidos\")\nlibrary(zoo)\n\n###AHORA LIMPIAMOS LOS DATOS PARA TRABAJAR MEJOR CON ELLOS###\n\n#-------------------Indice de precios de la Vivienda----------------------------\n\ncv <- import(file = \"./docs/datos/cv.csv\")\n\n#Elimino las columnas duplicadas indicando el nombre de la provincia \n#para dejar solo una columna de provincias\n\ncv <- cv[-1,]\ncolnames(cv) <- NULL\ncolumnas_duplicadas <- duplicated(t(cv))\nprint(columnas_duplicadas)\n#>  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n#> [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE\n#> [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n#> [37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE\n#> [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n#> [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n#> [73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE\n\ncv <- cv[, !columnas_duplicadas]\ncolnames(cv) <- paste0(\"col_\", 1:ncol(cv))\n#Elimino otra columnaa duplicadaa que el argumento no encuenrtra \n\ncv <- cv[, -62]\n\n#Doy nombre a la posición [1,2] de provincias para después poder trabajar mejor\n#Ya que convertiremos la primera fila en colnames\n\ncv[1,2] <- \"Provincia\"\ncolnames(cv)\n#>  [1] \"col_1\"  \"col_2\"  \"col_3\"  \"col_4\"  \"col_5\"  \"col_6\"  \"col_7\"  \"col_8\" \n#>  [9] \"col_9\"  \"col_10\" \"col_11\" \"col_12\" \"col_13\" \"col_14\" \"col_15\" \"col_16\"\n#> [17] \"col_17\" \"col_18\" \"col_19\" \"col_20\" \"col_21\" \"col_22\" \"col_23\" \"col_24\"\n#> [25] \"col_25\" \"col_26\" \"col_27\" \"col_28\" \"col_29\" \"col_30\" \"col_31\" \"col_32\"\n#> [33] \"col_33\" \"col_34\" \"col_35\" \"col_36\" \"col_37\" \"col_38\" \"col_39\" \"col_40\"\n#> [41] \"col_41\" \"col_42\" \"col_43\" \"col_44\" \"col_45\" \"col_46\" \"col_47\" \"col_48\"\n#> [49] \"col_49\" \"col_50\" \"col_51\" \"col_52\" \"col_53\" \"col_54\" \"col_55\" \"col_56\"\n#> [57] \"col_57\" \"col_58\" \"col_59\" \"col_60\" \"col_61\" \"col_63\" \"col_64\" \"col_65\"\n#> [65] \"col_66\" \"col_67\" \"col_68\" \"col_69\" \"col_70\" \"col_71\" \"col_72\" \"col_73\"\n#> [73] \"col_74\" \"col_75\" \"col_76\" \"col_77\" \"col_78\" \"col_79\" \"col_80\" \"col_81\"\n#> [81] \"col_82\"\n\n#Seleccionamos la primera fila del df y lo convertimos en un vector. Después, \n#Hacemos que los NA se sustituyan por el texto de su izquierda (Remplazamos NA`s\n#por el año al que corresponde esa columnas)\n\ndf <- cv %>%\n  slice(1) %>%\n  unlist()\n\ndf <- na.locf(df)\n\n#Ahora convertimos el vector en la fila 1 que después convrtiremos en colnames\n#para trabajar mejor.\n\ncv[1,] <- df \n\n#Juntamos la fila 1 y 2 a partir de la tercer columna separando el texto con \"_\" \n#y le rellenamos las dos columnas restantes con los nombres que nos vengan mejor \n#para trabajar\naa <- cv[1,]\naa <- c(\"\",\"Provincia\",paste(cv[1,3:ncol(cv)],cv[2,3:ncol(cv)], sep = \"_\"))\n\n#Convertimos el vector aa en colnames\n\ncolnames(cv) = aa\n\n#Quitamos la primera y la segunda fila, es información que ya indica colnames\n\ncv <- cv[-(1:2), -(1)]\ncolnames(cv)\n#>  [1] \"Provincia\"        \"Año 2009_1º\"      \"Año 2009_2º\"      \"Año 2009_3º\"     \n#>  [5] \"Año 2009_4º\"      \"Año 2010_1º\"      \"Año 2010_2º\"      \"Año 2010_3º\"     \n#>  [9] \"Año 2010_4º\"      \"Año 2011_1º\"      \"Año 2011_2º\"      \"Año 2011_3º\"     \n#> [13] \"Año 2011_4º\"      \"Año 2012_1º\"      \"Año 2012_2º\"      \"Año 2012_3º\"     \n#> [17] \"Año 2012_4º\"      \"Año 2013_1º\"      \"Año 2013_2º\"      \"Año 2013_3º\"     \n#> [21] \"Año 2013_4º\"      \"Año 2014_1º\"      \"Año 2014_2º\"      \"Año 2014_3º\"     \n#> [25] \"Año 2014_4º\"      \"Año 2015_1º\"      \"Año 2015_2º\"      \"Año 2015_3º\"     \n#> [29] \"Año 2015_4º\"      \"Año 2016_1º\"      \"Año 2016_2º\"      \"Año 2016_3º\"     \n#> [33] \"Año 2016_4º\"      \"Año 2017_1º\"      \"Año 2017_2º\"      \"Año 2017_3º\"     \n#> [37] \"Año 2017_4º\"      \"Año 2018_1º\"      \"Año 2018_2º\"      \"Año 2018_3º\"     \n#> [41] \"Año 2018_4º\"      \"Año 2019_1º\"      \"Año 2019_2º\"      \"Año 2019_3º\"     \n#> [45] \"Año 2019_4º\"      \"Año 2020_1º\"      \"Año 2020_2º\"      \"Año 2020_3º\"     \n#> [49] \"Año 2020_4º\"      \"Año 2021_1º\"      \"Año 2021_2º\"      \"Año 2021_3º\"     \n#> [53] \"Año 2021_4º\"      \"Año 2022_1º\"      \"Año 2022_2º\"      \"Año 2022_3º\"     \n#> [57] \"Año 2022_4º\"      \"Año 2023_1º\"      \"Año 2023_2º\"      \"Año 2023_3º (**)\"\n#> [61] \"Año 2004_1º\"      \"Año 2004_2º\"      \"Año 2004_3º\"      \"Año 2004_4º\"     \n#> [65] \"Año 2005_1º\"      \"Año 2005_2º\"      \"Año 2005_3º\"      \"Año 2005_4º\"     \n#> [69] \"Año 2006_1º\"      \"Año 2006_2º\"      \"Año 2006_3º\"      \"Año 2006_4º\"     \n#> [73] \"Año 2007_1º\"      \"Año 2007_2º\"      \"Año 2007_3º\"      \"Año 2007_4º\"     \n#> [77] \"Año 2008_1º\"      \"Año 2008_2º\"      \"Año 2008_3º\"      \"Año 2008_4º\"\n\n#Hacemos que todas las columnas que indican año_trimestre pivoten y dejen los\n#valores que contenían las transacciones por un lado y el año_trimestre por otro\n\nTransacciones_por_provincia <- cv %>% pivot_longer(cols = starts_with(\"Año\"), \n                                                   names_to = \"Año_Trimestre\", \n                                                   names_prefix = \"Año\", \n                                                   values_to = \"Transacciones\",\n                                                   values_drop_na = TRUE)\n\n#Guardamos en la carpeta(en formato .csv) de datos pulidos y seguimos\n\nwrite.csv(Transacciones_por_provincia, \n          file = \"datos_pulidos/Transacciones_por_povincia.csv\")\n\n#----------------Índice de precios de la vivienda-------------------------------\n\n\nipv <- import(file = \"./docs/datos/ipv.csv\")\n\n#Estos datos están bien, quitamos las dos columnas que no aportan y los guardamos\nipv <- ipv[,-(1:2)]\n\nwrite.csv(ipv, file = \"./datos_pulidos/indice_precio_vivienda.csv\")\n\n#rm(list = ls())\n\n\n#----------------Renta por edad-------------------------------------------------\n\nre <- import(file  = \"./docs/datos/renta_edad.csv\")\n\n#Renombramos las columnas, seleccionamos lo que nos interesa y borramos el restante\n#Exportamos\nre <- re %>%\n  rename(renta = \"value\") %>%\n  select(!c(\"V1\", \"X\"))\n\nwrite.csv(re, file = \"./datos_pulidos/renta_por_edad.csv\")\n\n\n\n\n#----------------Régimen tenencia de vivienda por edad--------------------------\n\nvd <- import(file  = \"./docs/datos/vivienda_datos.csv\")\n\n#Renombramos las columnas, seleccionamos lo que nos interesa y borramos el restante\n#Exportamos\nvd<- vd %>%\n  rename(Porcentaje = \"value\") %>%\n  select(!c(\"V1\", \"X\"))\n\nwrite.csv(vd, file = \"./datos_pulidos/tenencia_de_vivienda.csv\")\nrm(list = ls())\n\n#--------------------IMPORTAR DATOS CE / EUROSTAT-------------------------------\noptions(scipen = 999) #- para quitar la notación científica\n\nlibrary(eurostat) \nlibrary(DT) \nlibrary(tidyverse)\n\ninfo <- search_eurostat(\"GDP\", type = \"all\")\nmy_table <-\"sdg_08_10\"\n\n#Comprobamos que es el PIB pc\nlabel_eurostat_tables(my_table)\n#> [1] \"Real GDP per capita\"\n\ndf_original <- get_eurostat(my_table, time_format = 'raw', keepFlags = TRUE)\ndf_names <- names(df_original)\ndf_original <- label_eurostat(df_original, code = df_names, fix_duplicated = TRUE)\n\n#Creamos otro df para trabajor con él \n\ndf <- df_original\n\n#Ver que hay en el df\ndf_aa <- pjpv.curso.R.2022::pjp_dicc(df)\ndf_bb <- pjpv.curso.R.2022::pjp_valores_unicos(df, nn = 400)\n\n#Vamos a hacer un poco de limpieza\nobj_buenos <- c(\"df\", \"df_original\", \"df_bb\")\nrm(list = setdiff(ls(), obj_buenos))\n\n#Vamos a seguir arreglando el df\n\ndf <- df |> \n  rename(year = time_code) |> \n  rename(PIB_pc = values) |> \n  rename(country = geo)\n\n#Chain linked volumes (2010), euro per capita\n#Solo queremos el PIB_pc\ndf <- df |> \n  filter(unit == \"Chain linked volumes (2010), euro per capita\")\n\n#Eliminamos todo lo que nos molesta a la vista \ndf <- df |> \n  select(-c(unit_code, values_code, unit, time, na_item_code, na_item, flags))\n\ndf <- df |>  mutate(year =  as.numeric(year))\n\ndf <- df |>  mutate(iso_2_code =  eurostat::harmonize_country_code(geo_code))\n\ndf <- df |> \n  select(-c(geo_code, flags_code))\n\n\nlibrary(fs)\ndir_create(\"datos_pulidos\")\n\n#A continuación vamos a exportar los datos para luego importarlas más fácilmente #library(rio)\n\nexport(df, \"./datos_pulidos/PIB_pc.csv\", type = \"csv\")\n#---------------DATOS SOBRE EL SALARIO POR NIVEL DE FORMACIÓN-------------------\n\nlibrary(rio)\nlibrary(tidyverse)\nurl <- \"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/13931.csv?nocab=1\"\ndf_ine <- import(url)\ndf_ine_01 <- df_ine |> \n  filter(Decil %in% (\"Total decil\")) |> \n  select(\"Periodo\", \"Tipo de jornada\", \"NIVELES DE FORMACION\", \"Total\") |> \n  rename(year = Periodo) |> \n  rename(jornada = 'Tipo de jornada') |> \n  rename(formacion = 'NIVELES DE FORMACION') |>\n  rename(salario = Total)\n\n#VAMOS A CONVERTIR LA VARIABLE salario A NUMERIC\n\n#R y el INE me han jodiedo la vida para pasar esto a numeric (antes no funcionaba)\ndf_ine_01 <- df_ine_01 |> \n  mutate(salario = as.numeric(gsub(\",\", \".\", gsub(\"\\\\.\", \"\", salario))))\n\nexport(df_ine_01,\"./datos_pulidos/salario_formacion.csv\", type = \"csv\")\n\n#salarios por edades\nurl_1 <- \"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/13928.csv?nocab=1\"\ndf_ine_x1 <- import(url_1)\n\ndf_ine_02 <- df_ine_x1 |> \n  filter(Decil %in% (\"Total decil\")) |>\n  select(\"Periodo\", \"Tipo de jornada\", \"Grupo de edad\", \"Total\") |> \n  rename(year = Periodo) |> \n  rename(jornada = 'Tipo de jornada') |> \n  rename(grupo_edad = 'Grupo de edad') |>\n  rename(salario = Total)\n\n#PASAMOS A NUMERIC\ndf_ine_02 <- df_ine_02 |> \n  mutate(salario = as.numeric(gsub(\",\", \".\", gsub(\"\\\\.\", \"\", salario))))\n\nexport(df_ine_02,\"./datos_pulidos/salario_grupo_edad.csv\", type = \"csv\")\n#Datos sobre el IPC\n\nurl_2 <- \"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/50908.csv?nocab=1\"\ndf_ipc <- import(url_2)\n\ndf_ipc_01 <- df_ipc |> \n  filter(`Grupos ECOICOP` %in% c(\"Índice general\", \"04 Vivienda, agua, electricidad, gas y otros combustibles\")) |> \n  select(\"Periodo\", \"Grupos ECOICOP\", \"Tipo de dato\", \"Total\") |> \n  rename(year = Periodo) |>\n  rename(grupo = 'Grupos ECOICOP') |> \n  rename(tipo_dato = `Tipo de dato` ) \n\n#PASAMOS A NUMERIC\ndf_ipc_01 <- df_ipc_01 |> \n  mutate(Total = as.numeric(gsub(\",\", \".\", gsub(\"\\\\.\", \"\", Total))))\n\n#PARA SEPARAR EN LA VARIABLE YEAR LOS DATOS POR AÑOS Y MESES\n#df_sep <- df_ipc_01 |> \n#  separate(col = year, into = c(\"year\", \"month\"), sep = \"M\")\n\n#df_sep <- df_sep |> \n#  mutate(month = paste0(\"M\", month))\n\nexport(df_ipc_01, \"./datos_pulidos/IPC_mas_vivienda.csv\", type = \"csv\")\n\n#Por tipo de jornada\ndf_temporal <- import(\"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/10894.csv?nocab=1\")\ndf_contrato <- import(\"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/4854.csv?nocab=1\")\ndf_contrato <- df_contrato %>%\nfilter(Sexo %in% \"Ambos sexos\")\nwrite.csv(df_temporal, file= \"./datos_pulidos/temporalidad_edad.csv\")\nwrite.csv(df_contrato, file = \"./datos_pulidos/contrato_edad.csv\")\n\n#-------------------------Paro-----------------------------------\ndf_activos <- import(\"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/4049.csv?nocab=1\")\ndf_parados <- import(\"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/4084.csv?nocab=1\")\ndf_activos <- df_activos %>%\nfilter(Sexo %in% \"Ambos sexos\") %>%\nfilter(Unidad %in% \"Valor absoluto\")\ndf_parados <- df_parados %>%\nfilter(Sexo %in% \"Ambos sexos\") %>%\nfilter(Unidad %in% \"Valor absoluto\")\n\n#Saúl\n#-------------------------Por tipo de jornada-----------------------------------\n\ndf_temporal <- import(\"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/10894.csv?nocab=1\")\ndf_contrato <- import(\"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/4854.csv?nocab=1\")\n\ndf_contrato <- df_contrato %>%\n  filter(Sexo %in% \"Ambos sexos\")\n\n\n\nwrite.csv(df_temporal, file= \"./datos_pulidos/temporalidad_edad.csv\")\nwrite.csv(df_contrato, file = \"./datos_pulidos/contrato_edad.csv\")\n\n#Saúl\n#-------------------------Paro-----------------------------------\n\n\ndf_activos <- import(\"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/4049.csv?nocab=1\")\ndf_parados <- import(\"https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/4084.csv?nocab=1\")\n\n\ndf_activos <- df_activos %>%\n  filter(Sexo %in% \"Ambos sexos\") %>%\n  filter(Unidad %in% \"Valor absoluto\")\n\n\ndf_parados <- df_parados %>%\n  filter(Sexo %in% \"Ambos sexos\") %>%\n  filter(Unidad %in% \"Valor absoluto\")\n\nexport(df_activos, file = \"./datos_pulidos/activos.csv\", format=\"csv\")\nexport(df_parados, file = \"./datos_pulidos/parados.csv\", format=\"csv\")\n```\n:::\n\n\n:::\n\n---\n\n# Evolución de la renta neta por edad\n\nIniciaremos analizando los datos de renta según la edad (como pueden imaginar, los jóvenes constituyen el grupo poblacional que dispone de menos renta), para, a continuación, adentrarnos en datos que muestran la evolución de los precios de la vivienda.\n\n\n::: {.panel-tabset}\n\n# Gráfico en movimiento\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#Cargamos datos\nlibrary(rio)\nlibrary(tidyverse)\nlibrary(gganimate)\nlibrary(ggthemes)\nlibrary(hrbrthemes)\n\n#-\n\nrenta_edad <- read.csv(\"./datos_pulidos/renta_por_edad.csv\")\n\ndff  <- renta_edad %>% rename(tipo = Renta.anual.neta.media.por.persona.y.por.unidad.de.consumo) %>% filter(tipo == \"Renta neta media por persona\", Sexo == \"Ambos sexos\", !(Edad %in% c(\"De 18 a 64 años\", \"Menos de 18 años\", \"Total\")))\n\np <- ggplot(dff, aes(x = Periodo, y = renta, color = Edad)) +\n  geom_line(size = 1) +\n  labs(title = \"Evolución de la renta neta media por edad\", subtitle = \"(Euros corrientes)\",\n       x = \"Año\", y = \"Renta neta\", caption = \"Elaboración propia a partir de datos de INE\") +\n  theme_ipsum() + \n  theme(legend.position = \"bottom\",\n        panel.grid.major = element_line(colour = \"gray87\", linetype = \"dashed\"),\n        panel.background = element_rect(fill = \"aliceblue\"),\n        panel.grid.minor = element_blank(),\n        axis.text = element_text(family = \"serif\", size = 9, colour = \"gray17\")) + scale_color_manual(values = c(\"green4\", \"black\", \"blue\", \"red\", \"orange\")) +\n  geom_text(aes(label = Edad), nudge_x = 0.5, nudge_y = 0.5, hjust = 0)\n\np_animated <- p + transition_reveal(Periodo) +\n  enter_fade() + \n  exit_fade()\n\nanimate(p_animated, nframes = 200, fps = 20)\n```\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-2-1.gif){fig-align='center' width=95%}\n:::\n:::\n\n\n# Gráfico fijo interactivo\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(rio)\nlibrary(tidyverse)\nlibrary(gganimate)\nlibrary(ggthemes)\nlibrary(hrbrthemes)\n\nrenta_edad <- read.csv(\"./datos_pulidos/renta_por_edad.csv\")\n\ndff  <- renta_edad %>% rename(tipo = Renta.anual.neta.media.por.persona.y.por.unidad.de.consumo) %>% filter(tipo == \"Renta neta media por persona\", Sexo == \"Ambos sexos\", !(Edad %in% c(\"De 18 a 64 años\", \"Menos de 18 años\", \"Total\")))\n\np6 <- ggplot(data=dff) +\n  geom_line(aes(x = Periodo, y = renta, color = Edad, group = Edad)) +labs (title = \"Evolución de la renta neta media por edad\", subtitle = \"(En euros corrientes)\", y = \"Renta\", x = \"Año\") + theme_ipsum()\n\nplotly::ggplotly(p6)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-57bdfec56a0b26fd448f\" style=\"width:95%;height:480px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-57bdfec56a0b26fd448f\">{\"x\":{\"data\":[{\"x\":[2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],\"y\":[10893,11685,11783,11463,11867,11960,12183,12206,12416,12528,12758,13315,14132,14426,14762],\"text\":[\"Periodo: 2008<br />renta: 10893<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2009<br />renta: 11685<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2010<br />renta: 11783<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2011<br />renta: 11463<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2012<br />renta: 11867<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2013<br />renta: 11960<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2014<br />renta: 12183<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2015<br />renta: 12206<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2016<br />renta: 12416<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2017<br />renta: 12528<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2018<br />renta: 12758<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2019<br />renta: 13315<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2020<br />renta: 14132<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2021<br />renta: 14426<br />Edad: 65 y más años<br />Edad: 65 y más años\",\"Periodo: 2022<br />renta: 14762<br />Edad: 65 y más años<br />Edad: 65 y más años\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"65 y más años\",\"legendgroup\":\"65 y más años\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],\"y\":[10321,10797,10651,10032,9727,9438,9004,8935,9373,9815,10156,10345,11031,10903,11660],\"text\":[\"Periodo: 2008<br />renta: 10321<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2009<br />renta: 10797<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2010<br />renta: 10651<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2011<br />renta: 10032<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2012<br />renta:  9727<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2013<br />renta:  9438<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2014<br />renta:  9004<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2015<br />renta:  8935<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2016<br />renta:  9373<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2017<br />renta:  9815<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2018<br />renta: 10156<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2019<br />renta: 10345<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2020<br />renta: 11031<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2021<br />renta: 10903<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\",\"Periodo: 2022<br />renta: 11660<br />Edad: De 16 a 29 años<br />Edad: De 16 a 29 años\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(163,165,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"De 16 a 29 años\",\"legendgroup\":\"De 16 a 29 años\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],\"y\":[11024,11687,11480,11106,10912,10543,10348,10353,10536,11040,11397,11422,12053,12012,12974],\"text\":[\"Periodo: 2008<br />renta: 11024<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2009<br />renta: 11687<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2010<br />renta: 11480<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2011<br />renta: 11106<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2012<br />renta: 10912<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2013<br />renta: 10543<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2014<br />renta: 10348<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2015<br />renta: 10353<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2016<br />renta: 10536<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2017<br />renta: 11040<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2018<br />renta: 11397<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2019<br />renta: 11422<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2020<br />renta: 12053<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2021<br />renta: 12012<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\",\"Periodo: 2022<br />renta: 12974<br />Edad: De 30 a 44 años<br />Edad: De 30 a 44 años\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,191,125,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"De 30 a 44 años\",\"legendgroup\":\"De 30 a 44 años\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],\"y\":[12413,12906,13047,12374,12270,11921,11626,11591,11931,12311,12550,12988,13626,13373,14225],\"text\":[\"Periodo: 2008<br />renta: 12413<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2009<br />renta: 12906<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2010<br />renta: 13047<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2011<br />renta: 12374<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2012<br />renta: 12270<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2013<br />renta: 11921<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2014<br />renta: 11626<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2015<br />renta: 11591<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2016<br />renta: 11931<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2017<br />renta: 12311<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2018<br />renta: 12550<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2019<br />renta: 12988<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2020<br />renta: 13626<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2021<br />renta: 13373<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\",\"Periodo: 2022<br />renta: 14225<br />Edad: De 45 a 64 años<br />Edad: De 45 a 64 años\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,176,246,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"De 45 a 64 años\",\"legendgroup\":\"De 45 a 64 años\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],\"y\":[8005,8444,8355,8259,8151,7741,7726,7841,8078,8354,8919,8899,9025,9036,9605],\"text\":[\"Periodo: 2008<br />renta:  8005<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2009<br />renta:  8444<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2010<br />renta:  8355<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2011<br />renta:  8259<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2012<br />renta:  8151<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2013<br />renta:  7741<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2014<br />renta:  7726<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2015<br />renta:  7841<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2016<br />renta:  8078<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2017<br />renta:  8354<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2018<br />renta:  8919<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2019<br />renta:  8899<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2020<br />renta:  9025<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2021<br />renta:  9036<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\",\"Periodo: 2022<br />renta:  9605<br />Edad: Menores de 16 años<br />Edad: Menores de 16 años\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(231,107,243,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Menores de 16 años\",\"legendgroup\":\"Menores de 16 años\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":95.701120797011214,\"r\":39.850560398505614,\"b\":86.841012868410132,\"l\":93.814860938148641},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483},\"title\":{\"text\":\"<b> Evolución de la renta neta media por edad <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":23.910336239103366},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[2007.3,2022.7],\"tickmode\":\"array\",\"ticktext\":[\"2008\",\"2012\",\"2016\",\"2020\"],\"tickvals\":[2008,2012,2016,2020],\"categoryorder\":\"array\",\"categoryarray\":[\"2008\",\"2012\",\"2016\",\"2020\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.8190120381901207,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(204,204,204,1)\",\"gridwidth\":0.265670402656704,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Año\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":11.955168119551683}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[7374.1999999999998,15113.799999999999],\"tickmode\":\"array\",\"ticktext\":[\"9000\",\"11000\",\"13000\",\"15000\"],\"tickvals\":[9000,11000,13000,15000],\"categoryorder\":\"array\",\"categoryarray\":[\"9000\",\"11000\",\"13000\",\"15000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.8190120381901207,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(204,204,204,1)\",\"gridwidth\":0.26567040265670405,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Renta\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":11.955168119551683}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":12.220838522208389},\"title\":{\"text\":\"Edad\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"36745a2f219\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"}},\"cur_data\":\"36745a2f219\",\"visdat\":{\"36745a2f219\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n:::\n\nTenemos este primer gráfico dinámico, que básicamente lo hemos hecho para demostrar que lo podemos hacer. Sabemos que no es especialmente útil, pero sí vistoso, por eso hemos hecho esta presión interactiva pero estática del mismo gráfico, para un mejor análisis acceded al fijo interactivo.\n\nEn este gráfico, cuyos datos están extraídos del INE podemos observar, como ya anticipábamos, que los jóvenes (16-29 años de edad) son el rango de edad que dispone de menos renta. Más notorio es, claro está, con los menores de 16 años. Los jóvenes de 16 a 29 años contaban con una renta media neta o disponible (después de impuestos) de 11.660€.\n\n- La diferencia con el grupo de 30 a 44 años ha pasado de un 6’38% en 2008 a 10’13% en 2022. Un incremento de un 58’78%.\n\n- Con el grupo de 45 a 64 años del 16’86% mencionado arriba a un 18’03%. Un incremento de un 6’94%.\n\n- La mayor divergencia se da con el grupo de los mayores de 65 años. De una diferencia del 6’03% en 2008 a una del 21% en 2022. Un espectacular incremento del 248’23%.\n\nPor tanto, la renta de lo jóvenes de entre 16 y 29 años es la que menos ha crecido: tan solo un 12’97% en 14 años.\n\nComo podemos observar, no sólo es que los jóvenes tengan una renta disponible menor, si no que cada vez se queda más atrás respecto al resto. Los jóvenes, en términos de renta, son cada vez relativamente más pobres.\n\n---\n\n## Porcentaje de parados según la edad\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n\n#Paquetes\nlibrary(reshape2)\nlibrary(tidyverse)\nlibrary(car) # regression analysis\nlibrary(plotly)\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(xts)\nlibrary(dygraphs)\nlibrary(gifski)\nlibrary(ggthemes)\n#rm(list = ls())\n#Df`s\n#---------------------Tipo de contrato------------------------------------------\ndf_contrato <- read.csv(\"./datos_pulidos/contrato_edad.csv\")\n#----------------------Arreglamos-----------------------------------------------\nhead(df_contrato)\n#>   X        Sexo  Edad Tipo.de.jornada   Tipo.de.dato Periodo    Total\n#> 1 1 Ambos sexos Total           Total Valor absoluto    2022 20.390,6\n#> 2 2 Ambos sexos Total           Total Valor absoluto    2021 19.773,6\n#> 3 3 Ambos sexos Total           Total Valor absoluto    2020 19.202,4\n#> 4 4 Ambos sexos Total           Total Valor absoluto    2019 19.779,3\n#> 5 5 Ambos sexos Total           Total Valor absoluto    2018 19.327,7\n#> 6 6 Ambos sexos Total           Total Valor absoluto    2017 18.824,8\ndf_contrato <- df_contrato %>%\nmutate(Total = gsub(\"\\\\.\", \"\", Total))\ndf_contrato <- df_contrato %>%\nmutate(Total = as.numeric(gsub(\",\", \".\", Total)))\nhead(df_contrato)\n#>   X        Sexo  Edad Tipo.de.jornada   Tipo.de.dato Periodo   Total\n#> 1 1 Ambos sexos Total           Total Valor absoluto    2022 20390.6\n#> 2 2 Ambos sexos Total           Total Valor absoluto    2021 19773.6\n#> 3 3 Ambos sexos Total           Total Valor absoluto    2020 19202.4\n#> 4 4 Ambos sexos Total           Total Valor absoluto    2019 19779.3\n#> 5 5 Ambos sexos Total           Total Valor absoluto    2018 19327.7\n#> 6 6 Ambos sexos Total           Total Valor absoluto    2017 18824.8\ndf_contrato <- df_contrato %>%\nfilter(Tipo.de.jornada %in% c(\"Jornada a tiempo completo\", \"Jornada a tiempo parcial\")) %>%\nfilter(Tipo.de.dato %in% \"Porcentaje\")\ndf_contrato_pivot <- df_contrato %>%\npivot_wider(names_from = \"Tipo.de.jornada\", values_from = \"Total\")\ndf_contrato_pivot <- df_contrato_pivot[,-(1:2)]\nde16a34 <- df_contrato_pivot %>%\nfilter(Edad %in% c(\"De 25 a 29 años\", \"De 16 a 19 años\", \"De 20 a 24 años\", \"De 30 a 34\naños\"))\ncolumna <- rep(\"De 16 a 34 años\", times = 17)\nde16a34 <- de16a34 %>%\nmutate_all(~replace(., is.na(.), 0))\n##\nde16a34 <- de16a34 %>%\ngroup_by(Periodo) %>%\nsummarise(tiempo_completo = sum(`Jornada a tiempo completo`)/4,\ntiempo_parcial = sum(`Jornada a tiempo parcial`)/4) %>%\nmutate(Edad = columna)\nmas35 <- df_contrato_pivot %>%\nfilter(Edad %in% c(\"70 y más años\", \"De 35 a 39 años\", \"De 40 a 44 años\", \"De 45 a 49\naños\", \"De 50 a 54 años\", \"De 55 a 59 años\", \"De 60 a 64 años\", \"De 65 a 69 años\"))\ncolumna <- rep(\"Mayores de 35\", times = 17)\nmas35 <- mas35 %>%\nmutate_all(~replace(., is.na(.), 0))\nmas35 <- mas35 %>%\ngroup_by(Periodo) %>%\nsummarise(tiempo_completo = sum(`Jornada a tiempo completo`)/8,\ntiempo_parcial = sum(`Jornada a tiempo parcial`)/8) %>%\nmutate(Edad = columna)\ncontrato <- rbind(mas35, de16a34)\nrm(list = ls()[!ls() %in% c(\"salario\",\"contrato\")])\n##-------------------------Póblación Activa----------------------------------------------\ndf_activos <- read.csv(\"./datos_pulidos/activos.csv\")\n##-------------------------Arreglamos-----------------------------------------------------\nhead(df_activos)\n#>    Edad        Sexo         Unidad Periodo    Total\n#> 1 Total Ambos sexos Valor absoluto  2023T3 24.121,0\n#> 2 Total Ambos sexos Valor absoluto  2023T2 23.819,2\n#> 3 Total Ambos sexos Valor absoluto  2023T1 23.580,5\n#> 4 Total Ambos sexos Valor absoluto  2022T4 23.487,8\n#> 5 Total Ambos sexos Valor absoluto  2022T3 23.525,9\n#> 6 Total Ambos sexos Valor absoluto  2022T2 23.387,4\ndf_activos <- df_activos %>%\nmutate(Total = gsub(\"\\\\.\", \"\", Total))\ndf_activos <- df_activos %>%\nmutate(Total = as.numeric(gsub(\",\", \".\", Total)))\nhead(df_activos)\n#>    Edad        Sexo         Unidad Periodo   Total\n#> 1 Total Ambos sexos Valor absoluto  2023T3 24121.0\n#> 2 Total Ambos sexos Valor absoluto  2023T2 23819.2\n#> 3 Total Ambos sexos Valor absoluto  2023T1 23580.5\n#> 4 Total Ambos sexos Valor absoluto  2022T4 23487.8\n#> 5 Total Ambos sexos Valor absoluto  2022T3 23525.9\n#> 6 Total Ambos sexos Valor absoluto  2022T2 23387.4\nmenos35 <- df_activos %>%\nfilter(Edad %in% c(\"De 25 a 29 años\", \"De 16 a 19 años\", \"De 20 a 24 años\", \"De 30 a 34\naños\"))\nhead(menos35)\n#>              Edad        Sexo         Unidad Periodo Total\n#> 1 De 16 a 19 años Ambos sexos Valor absoluto  2023T3 353.4\n#> 2 De 16 a 19 años Ambos sexos Valor absoluto  2023T2 284.3\n#> 3 De 16 a 19 años Ambos sexos Valor absoluto  2023T1 258.7\n#> 4 De 16 a 19 años Ambos sexos Valor absoluto  2022T4 268.2\n#> 5 De 16 a 19 años Ambos sexos Valor absoluto  2022T3 333.2\n#> 6 De 16 a 19 años Ambos sexos Valor absoluto  2022T2 295.7\nmenos35 <- menos35 %>%\nmutate(Año = substr(Periodo, 1, 4)) %>%\ngroup_by(Edad, Sexo, Unidad, Año) %>%\nsummarise(Total = sum(Total)/4)\nmenos35 <- menos35[,-(2:3)]\ncolumna <- rep(\"De 16 a 34 años\", times = 22)\nmenos35 <- menos35 %>%\ngroup_by(Año) %>%\nsummarise(total = sum(Total)) %>%\nmutate(grupo_edad = columna) %>%\nfilter(!Año %in% c(\"2023\")) %>%\nrename(num_activos = \"total\")\nmas35 <- df_activos %>%\nfilter(Edad %in% c(\"70 y más años\", \"De 35 a 39 años\", \"De 40 a 44 años\", \"De 45 a 49\naños\", \"De 50 a 54 años\", \"De 55 a 59 años\", \"De 60 a 64 años\", \"De 65 a 69 años\"))\nmas35 <- mas35 %>%\nmutate(Año = substr(Periodo, 1, 4)) %>%\ngroup_by(Edad, Sexo, Unidad, Año) %>%\nsummarise(Total = sum(Total)/4)\nmas35 <- mas35[,-(2:3)]\ncolumna <- rep(\"Mayores de 35\", times = 22)\nmas35 <- mas35 %>%\ngroup_by(Año) %>%\nsummarise(total = sum(Total)) %>%\nmutate(grupo_edad = columna) %>%\nfilter(!Año %in% c(\"2023\")) %>%\nrename(num_activos = \"total\")\nactivos <- rbind(mas35, menos35)\nrm(list = ls()[!ls() %in% c(\"salario\",\"contrato\", \"activos\")])\n##-----------------------------Póblación parada---------------------------------\ndf_parados <- read.csv(\"./datos_pulidos/parados.csv\")\n##-----------------------------Arreglamos y sacamos la población ocupada--------\nhead(df_parados)\n#>    Edad        Sexo         Unidad Periodo   Total\n#> 1 Total Ambos sexos Valor absoluto  2023T3 2.855,2\n#> 2 Total Ambos sexos Valor absoluto  2023T2 2.762,5\n#> 3 Total Ambos sexos Valor absoluto  2023T1 3.127,8\n#> 4 Total Ambos sexos Valor absoluto  2022T4 3.024,0\n#> 5 Total Ambos sexos Valor absoluto  2022T3 2.980,2\n#> 6 Total Ambos sexos Valor absoluto  2022T2 2.919,4\ndf_parados <- df_parados %>%\nmutate(Total = gsub(\"\\\\.\", \"\", Total))\ndf_parados <- df_parados %>%\nmutate(Total = as.numeric(gsub(\",\", \".\", Total)))\nhead(df_parados)\n#>    Edad        Sexo         Unidad Periodo  Total\n#> 1 Total Ambos sexos Valor absoluto  2023T3 2855.2\n#> 2 Total Ambos sexos Valor absoluto  2023T2 2762.5\n#> 3 Total Ambos sexos Valor absoluto  2023T1 3127.8\n#> 4 Total Ambos sexos Valor absoluto  2022T4 3024.0\n#> 5 Total Ambos sexos Valor absoluto  2022T3 2980.2\n#> 6 Total Ambos sexos Valor absoluto  2022T2 2919.4\nmenos35 <- df_parados %>%\nfilter(Edad %in% c(\"De 25 a 29 años\", \"De 16 a 19 años\", \"De 20 a 24 años\", \"De 30 a 34\naños\"))\nhead(menos35)\n#>              Edad        Sexo         Unidad Periodo Total\n#> 1 De 16 a 19 años Ambos sexos Valor absoluto  2023T3 142.0\n#> 2 De 16 a 19 años Ambos sexos Valor absoluto  2023T2 122.1\n#> 3 De 16 a 19 años Ambos sexos Valor absoluto  2023T1 121.4\n#> 4 De 16 a 19 años Ambos sexos Valor absoluto  2022T4 114.8\n#> 5 De 16 a 19 años Ambos sexos Valor absoluto  2022T3 151.4\n#> 6 De 16 a 19 años Ambos sexos Valor absoluto  2022T2 144.0\nmenos35 <- menos35 %>%\nmutate(Año = substr(Periodo, 1, 4)) %>%\ngroup_by(Edad, Sexo, Unidad, Año) %>%\nsummarise(Total = sum(Total)/4)\nmenos35 <- menos35[,-(2:3)]\ncolumna <- rep(\"De 16 a 34 años\", times = 22)\nmenos35 <- menos35 %>%\ngroup_by(Año) %>%\nsummarise(total = sum(Total)) %>%\nmutate(grupo_edad = columna) %>%\nfilter(!Año %in% c(\"2023\")) %>%\nrename(num_parados = \"total\")\nmas35 <- df_parados %>%\nfilter(Edad %in% c(\"70 y más años\", \"De 35 a 39 años\", \"De 40 a 44 años\", \"De 45 a 49\naños\", \"De 50 a 54 años\", \"De 55 a 59 años\", \"De 60 a 64 años\", \"De 65 a 69 años\"))\nmas35 <- mas35 %>%\nmutate(Año = substr(Periodo, 1, 4)) %>%\ngroup_by(Edad, Sexo, Unidad, Año) %>%\nsummarise(Total = sum(Total)/4) %>%\nmutate_all(~replace(., is.na(.), 0))\nmas35 <- mas35[,-(2:3)]\ncolumna <- rep(\"Mayores de 35\", times = 22)\nmas35 <- mas35 %>%\ngroup_by(Año) %>%\nsummarise(total = sum(Total)) %>%\nmutate(grupo_edad = columna) %>%\nfilter(!Año %in% c(\"2023\")) %>%\nrename(num_parados = \"total\")\nparados <- rbind(mas35, menos35)\nrm(list = ls()[!ls() %in% c(\"salario\",\"contrato\", \"activos\", \"parados\")])\nact_parad <- merge(parados, activos, by = c(\"Año\", \"grupo_edad\"))\nact_parad <- act_parad %>%\nmutate(num_ocupados = num_activos - num_parados)\nrm(list = ls()[!ls() %in% c(\"salario\",\"contrato\", \"act_parad\")])\n##------------------------------Gráficos----------------------------------------\nhead(act_parad)\n#>    Año      grupo_edad num_parados num_activos num_ocupados\n#> 1 2002 De 16 a 34 años     973.125    5449.350     4476.225\n#> 2 2002   Mayores de 35     727.850    8622.975     7895.125\n#> 3 2003 De 16 a 34 años     999.050    5571.700     4572.650\n#> 4 2003   Mayores de 35     764.300    9043.125     8278.825\n#> 5 2004 De 16 a 34 años     942.150    5596.725     4654.575\n#> 6 2004   Mayores de 35     791.800    9414.925     8623.125\nporcentaje_parados <- act_parad %>%\ngroup_by(Año) %>%\ngroup_by(Año, grupo_edad) %>%\nmutate(Ocupados_edad = (num_ocupados / num_activos) * 100,\nParados_edad = (num_parados / num_activos) * 100) %>%\nrename(Periodo = Año)\nrm(list = ls()[!ls() %in% c(\"salario\",\"contrato\", \"porcentaje_parados\", \"vivienda\",\n\"act_parad\")])\ncontrato <- contrato %>%\nrename(jornada_completa = tiempo_completo,\njornada_parcial = tiempo_parcial,\ngrupo_edad = Edad)\nP2 <- ggplot(porcentaje_parados, aes(x = Periodo, y = Parados_edad, group = grupo_edad,\ncolor = grupo_edad)) +\ngeom_line() +\nscale_color_manual(values = c(\"blue\", \"red\")) +\ngeom_point( color=\"black\", size=2) +\ntheme_economist() +labs(title = \"Porcentaje de parados según la edad\", x = \"Periodo\", y =\n\"Porcentaje\", caption = \"Elaboración propia a partir de datos de INE\")\n\nplotly::ggplotly(P2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-9d59e5336acbb6bcb203\" style=\"width:95%;height:480px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-9d59e5336acbb6bcb203\">{\"x\":{\"data\":[{\"x\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],\"y\":[17.857634396762915,17.930793115207209,16.833951998713534,14.791175185670596,13.488376181831766,12.939783716197342,18.191172439823319,28.541922465568277,31.724913048100728,34.587602527901034,40.285940229048023,42.433889818370019,39.659317742645243,36.701547707690672,33.286792557162208,29.447122043100098,26.19892443310972,24.712726573392949,29.189494210672933,26.989417262231996,22.360807164050854],\"text\":[\"Periodo: 2002<br />Parados_edad: 17.857634<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2003<br />Parados_edad: 17.930793<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2004<br />Parados_edad: 16.833952<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2005<br />Parados_edad: 14.791175<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2006<br />Parados_edad: 13.488376<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2007<br />Parados_edad: 12.939784<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2008<br />Parados_edad: 18.191172<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2009<br />Parados_edad: 28.541922<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2010<br />Parados_edad: 31.724913<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2011<br />Parados_edad: 34.587603<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2012<br />Parados_edad: 40.285940<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2013<br />Parados_edad: 42.433890<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2014<br />Parados_edad: 39.659318<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2015<br />Parados_edad: 36.701548<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2016<br />Parados_edad: 33.286793<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2017<br />Parados_edad: 29.447122<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2018<br />Parados_edad: 26.198924<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2019<br />Parados_edad: 24.712727<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2020<br />Parados_edad: 29.189494<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2021<br />Parados_edad: 26.989417<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2022<br />Parados_edad: 22.360807<br />grupo_edad: De 16 a 34 años<br />grupo_edad: De 16 a 34 años\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,255,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"De 16 a 34 años\",\"legendgroup\":\"De 16 a 34 años\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],\"y\":[8.4408223379981973,8.4517243762526775,8.4100510625416565,6.8581135285323906,6.5030089534713049,6.5020215601853382,8.7769522895714989,14.188708852419222,16.115160257893031,17.286060378651307,20.270203010617394,21.571035208644183,20.54904585239067,18.442376635840333,16.641500706088532,14.551007689845996,12.906880482201158,11.923588388171872,12.550289616373966,12.312963272788112,11.189825554547479],\"text\":[\"Periodo: 2002<br />Parados_edad:  8.440822<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2003<br />Parados_edad:  8.451724<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2004<br />Parados_edad:  8.410051<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2005<br />Parados_edad:  6.858114<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2006<br />Parados_edad:  6.503009<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2007<br />Parados_edad:  6.502022<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2008<br />Parados_edad:  8.776952<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2009<br />Parados_edad: 14.188709<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2010<br />Parados_edad: 16.115160<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2011<br />Parados_edad: 17.286060<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2012<br />Parados_edad: 20.270203<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2013<br />Parados_edad: 21.571035<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2014<br />Parados_edad: 20.549046<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2015<br />Parados_edad: 18.442377<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2016<br />Parados_edad: 16.641501<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2017<br />Parados_edad: 14.551008<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2018<br />Parados_edad: 12.906880<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2019<br />Parados_edad: 11.923588<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2020<br />Parados_edad: 12.550290<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2021<br />Parados_edad: 12.312963<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\",\"Periodo: 2022<br />Parados_edad: 11.189826<br />grupo_edad: Mayores de 35<br />grupo_edad: Mayores de 35\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Mayores de 35\",\"legendgroup\":\"Mayores de 35\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21],\"y\":[17.857634396762915,8.4408223379981973,17.930793115207209,8.4517243762526775,16.833951998713534,8.4100510625416565,14.791175185670596,6.8581135285323906,13.488376181831766,6.5030089534713049,12.939783716197342,6.5020215601853382,18.191172439823319,8.7769522895714989,28.541922465568277,14.188708852419222,31.724913048100728,16.115160257893031,34.587602527901034,17.286060378651307,40.285940229048023,20.270203010617394,42.433889818370019,21.571035208644183,39.659317742645243,20.54904585239067,36.701547707690672,18.442376635840333,33.286792557162208,16.641500706088532,29.447122043100098,14.551007689845996,26.19892443310972,12.906880482201158,24.712726573392949,11.923588388171872,29.189494210672933,12.550289616373966,26.989417262231996,12.312963272788112,22.360807164050854,11.189825554547479],\"text\":[\"Periodo: 2002<br />Parados_edad: 17.857634<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2002<br />Parados_edad:  8.440822<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2003<br />Parados_edad: 17.930793<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2003<br />Parados_edad:  8.451724<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2004<br />Parados_edad: 16.833952<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2004<br />Parados_edad:  8.410051<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2005<br />Parados_edad: 14.791175<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2005<br />Parados_edad:  6.858114<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2006<br />Parados_edad: 13.488376<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2006<br />Parados_edad:  6.503009<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2007<br />Parados_edad: 12.939784<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2007<br />Parados_edad:  6.502022<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2008<br />Parados_edad: 18.191172<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2008<br />Parados_edad:  8.776952<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2009<br />Parados_edad: 28.541922<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2009<br />Parados_edad: 14.188709<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2010<br />Parados_edad: 31.724913<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2010<br />Parados_edad: 16.115160<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2011<br />Parados_edad: 34.587603<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2011<br />Parados_edad: 17.286060<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2012<br />Parados_edad: 40.285940<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2012<br />Parados_edad: 20.270203<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2013<br />Parados_edad: 42.433890<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2013<br />Parados_edad: 21.571035<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2014<br />Parados_edad: 39.659318<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2014<br />Parados_edad: 20.549046<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2015<br />Parados_edad: 36.701548<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2015<br />Parados_edad: 18.442377<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2016<br />Parados_edad: 33.286793<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2016<br />Parados_edad: 16.641501<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2017<br />Parados_edad: 29.447122<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2017<br />Parados_edad: 14.551008<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2018<br />Parados_edad: 26.198924<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2018<br />Parados_edad: 12.906880<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2019<br />Parados_edad: 24.712727<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2019<br />Parados_edad: 11.923588<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2020<br />Parados_edad: 29.189494<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2020<br />Parados_edad: 12.550290<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2021<br />Parados_edad: 26.989417<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2021<br />Parados_edad: 12.312963<br />grupo_edad: Mayores de 35<br />grupo_edad: black\",\"Periodo: 2022<br />Parados_edad: 22.360807<br />grupo_edad: De 16 a 34 años<br />grupo_edad: black\",\"Periodo: 2022<br />Parados_edad: 11.189826<br />grupo_edad: Mayores de 35<br />grupo_edad: black\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,0,0,1)\",\"opacity\":1,\"size\":7.559055118110237,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":53.858032378580326,\"r\":13.283520132835205,\"b\":38.522208385222093,\"l\":35.865504358655052},\"plot_bgcolor\":\"transparent\",\"paper_bgcolor\":\"rgba(213,228,235,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"<b> Porcentaje de parados según la edad <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":21.917808219178081},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,21.600000000000001],\"tickmode\":\"array\",\"ticktext\":[\"2002\",\"2003\",\"2004\",\"2005\",\"2006\",\"2007\",\"2008\",\"2009\",\"2010\",\"2011\",\"2012\",\"2013\",\"2014\",\"2015\",\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,14.999999999999998,15.999999999999998,17,18,19,20,21],\"categoryorder\":\"array\",\"categoryarray\":[\"2002\",\"2003\",\"2004\",\"2005\",\"2006\",\"2007\",\"2008\",\"2009\",\"2010\",\"2011\",\"2012\",\"2013\",\"2014\",\"2015\",\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(0,0,0,1)\",\"ticklen\":-6.6417600664175991,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.53134080531340799,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Periodo\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[4.7054281472761037,44.230483231279251],\"tickmode\":\"array\",\"ticktext\":[\"10\",\"20\",\"30\",\"40\"],\"tickvals\":[10,20,30,40],\"categoryorder\":\"array\",\"categoryarray\":[\"10\",\"20\",\"30\",\"40\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":-6.6417600664176026,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":1.16230801162308,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Porcentaje\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"transparent\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":18.264840182648406},\"title\":{\"text\":\"grupo_edad\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"367471122153\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"},\"36746d825c0f\":{\"x\":{},\"y\":{},\"colour\":{}}},\"cur_data\":\"367471122153\",\"visdat\":{\"367471122153\":[\"function (y) \",\"x\"],\"36746d825c0f\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\nEn este otro gráfico podemos observar además cómo la tasa de desempleo es muy superior en el caso de los menores de 35 años respecto a los mayores de 35 años, es decir, durante este primer tramo de edad, de 16 a 34 años, sufrirán un menor poder adquisitivo respecto a los mayores de 34 años.\n\n---\n\n## Porcentaje de contratos de Jornada completa por edad\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np3 <- ggplot(contrato, aes(x = Periodo, y = jornada_completa, fill = grupo_edad)) +\n  geom_col(position = \"dodge\") +\n  scale_fill_manual(values = c(\"blue3\", \"red3\"), name = NULL) +\n  theme_economist() +\n  labs(title = \"Contratos de jornada completa según la edad\", x = \"Periodo\", y = \"Porcentaje\", caption = \"Elaboración propia a partir de datos de INE\") \nplotly::ggplotly(p3)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-81d61a9760beb013c12e\" style=\"width:95%;height:480px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-81d61a9760beb013c12e\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[2005.7750000000001,2006.7750000000001,2007.7750000000001,2008.7750000000001,2009.7750000000001,2010.7750000000001,2011.7750000000001,2012.7750000000001,2013.7750000000001,2014.7750000000001,2015.7750000000001,2016.7750000000001,2017.7750000000001,2018.7750000000001,2019.7750000000001,2020.7750000000001,2021.7750000000001],\"y\":[60,60.125,58.899999999999999,56.674999999999997,54.325000000000003,51.274999999999999,49.900000000000006,47.324999999999996,46.475000000000001,47.200000000000003,47.225000000000001,48.100000000000001,48.674999999999997,48.674999999999997,48.075000000000003,47.5,48.399999999999999],\"text\":[\"Periodo: 2006<br />jornada_completa: 60.0000<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2007<br />jornada_completa: 60.1250<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2008<br />jornada_completa: 58.9000<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2009<br />jornada_completa: 56.6750<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2010<br />jornada_completa: 54.3250<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2011<br />jornada_completa: 51.2750<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2012<br />jornada_completa: 49.9000<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2013<br />jornada_completa: 47.3250<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2014<br />jornada_completa: 46.4750<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2015<br />jornada_completa: 47.2000<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2016<br />jornada_completa: 47.2250<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2017<br />jornada_completa: 48.1000<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2018<br />jornada_completa: 48.6750<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2019<br />jornada_completa: 48.6750<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2020<br />jornada_completa: 48.0750<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2021<br />jornada_completa: 47.5000<br />grupo_edad: De 16 a 34 años\",\"Periodo: 2022<br />jornada_completa: 48.4000<br />grupo_edad: De 16 a 34 años\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,0,205,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"De 16 a 34 años\",\"legendgroup\":\"De 16 a 34 años\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181,0.4499999999998181],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[2006.2249999999999,2007.2249999999999,2008.2249999999999,2009.2249999999999,2010.2249999999999,2011.2249999999999,2012.2249999999999,2013.2249999999999,2014.2249999999999,2015.2249999999999,2016.2249999999999,2017.2249999999999,2018.2249999999999,2019.2249999999999,2020.2249999999999,2021.2249999999999,2022.2249999999999],\"y\":[72.224999999999994,72.012500000000003,72.1875,71.637500000000003,72.450000000000003,72.349999999999994,71.737499999999997,71.125,70.325000000000003,71.775000000000006,71.637500000000003,72.462500000000006,71.737499999999997,71.637500000000003,71.9375,72.450000000000003,72.237499999999997],\"text\":[\"Periodo: 2006<br />jornada_completa: 72.2250<br />grupo_edad: Mayores de 35\",\"Periodo: 2007<br />jornada_completa: 72.0125<br />grupo_edad: Mayores de 35\",\"Periodo: 2008<br />jornada_completa: 72.1875<br />grupo_edad: Mayores de 35\",\"Periodo: 2009<br />jornada_completa: 71.6375<br />grupo_edad: Mayores de 35\",\"Periodo: 2010<br />jornada_completa: 72.4500<br />grupo_edad: Mayores de 35\",\"Periodo: 2011<br />jornada_completa: 72.3500<br />grupo_edad: Mayores de 35\",\"Periodo: 2012<br />jornada_completa: 71.7375<br />grupo_edad: Mayores de 35\",\"Periodo: 2013<br />jornada_completa: 71.1250<br />grupo_edad: Mayores de 35\",\"Periodo: 2014<br />jornada_completa: 70.3250<br />grupo_edad: Mayores de 35\",\"Periodo: 2015<br />jornada_completa: 71.7750<br />grupo_edad: Mayores de 35\",\"Periodo: 2016<br />jornada_completa: 71.6375<br />grupo_edad: Mayores de 35\",\"Periodo: 2017<br />jornada_completa: 72.4625<br />grupo_edad: Mayores de 35\",\"Periodo: 2018<br />jornada_completa: 71.7375<br />grupo_edad: Mayores de 35\",\"Periodo: 2019<br />jornada_completa: 71.6375<br />grupo_edad: Mayores de 35\",\"Periodo: 2020<br />jornada_completa: 71.9375<br />grupo_edad: Mayores de 35\",\"Periodo: 2021<br />jornada_completa: 72.4500<br />grupo_edad: Mayores de 35\",\"Periodo: 2022<br />jornada_completa: 72.2375<br />grupo_edad: Mayores de 35\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(205,0,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Mayores de 35\",\"legendgroup\":\"Mayores de 35\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":53.858032378580326,\"r\":13.283520132835205,\"b\":38.522208385222093,\"l\":35.865504358655052},\"plot_bgcolor\":\"transparent\",\"paper_bgcolor\":\"rgba(213,228,235,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"<b> Contratos de jornada completa según la edad <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":21.917808219178081},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[2004.7050000000002,2023.2949999999998],\"tickmode\":\"array\",\"ticktext\":[\"2005\",\"2010\",\"2015\",\"2020\"],\"tickvals\":[2005,2010,2015,2020],\"categoryorder\":\"array\",\"categoryarray\":[\"2005\",\"2010\",\"2015\",\"2020\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(0,0,0,1)\",\"ticklen\":-6.6417600664175991,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.53134080531340799,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Periodo\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-3.6231250000000004,76.085625000000007],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"20\",\"40\",\"60\"],\"tickvals\":[0,20,39.999999999999993,60],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"20\",\"40\",\"60\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":-6.6417600664176026,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":1.16230801162308,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Porcentaje\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"transparent\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":18.264840182648406},\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"3674b68c20\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"3674b68c20\",\"visdat\":{\"3674b68c20\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\nAdemás, en este gráfico de barras, podemos apreciar como los contratos a jornada completa han disminuido prácticamente 10 puntos porcentuales desde la Gran Recesión hasta nuestros días, mientras que los de los mayores de 35 años han permanecido estables.\n\nEl hecho de que los contratos no sean a jornada completa, influye de forma decisiva en que la renta final sea menor, ya que a menos horas trabajadas, menos horas cobradas.\n\n---\n\n# Índice del nivel de Precios de la vivienda a nivel nacional\n\nAhora vamos a analizar cómo se han comportado los precios de la vivienda en general. Primero lo vamos a hacer observando el comportamiento de los precios de forma general a nivel nacional. Luego veremos cómo se ha comportado en términos de tasas de variación, y más tarde, el nivel de precios por comunidades autónomas y en diferentes momentos del tiempo.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#Paquetes preliminares\n#install.packages(\"mapSpain\")\nlibrary(mapSpain)\n#install.packages(\"pxR\")\nlibrary(pxR)\n#install.packages(\"tidyverse\")\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(rlist)\nlibrary(fs)\nlibrary(curl)\nlibrary(rio)\nlibrary(sf)\nlibrary(readxl)\nlibrary(downloader)\nlibrary(writexl)\n#install.packages(\"rlist\")\n# install.packages(\"devtools\")\n#devtools::install_github(\"r-lib/conflicted\")\n#Creamos una carpeta para guardar los datos\n#Descargamos los datos en formato PX desde el Ine\n#Índice de Precios de Vivienda por CCAA: general, vivienda nueva y de segunda mano\n#Como la URL es: \"https://www.ine.es/jaxiT3/files/t/es/px/25171.px?nocab=1\"\nurl <- \"https://www.ine.es/jaxiT3/files/t/es/px/25171.px?nocab=1\"\naa <- read.px(url)\n#Lo convertimos a CSV para simplificar y creamos un dataframe\nwrite.csv(aa, file = \"./datos_pulidos/data.csv\", sep = \",\")\n#Lo convertimos a CSV para simplificar y creamos un dataframe\nwrite.csv(aa, file = \"./datos_pulidos/data.csv\")\ndf <- read.csv(\"./datos_pulidos/data.csv\")\n#Ahora nos ponemos a curra un poquito:\nlibrary(ggthemes)\n#install.packages(\"plotly\")\nlibrary(plotly)\n#install.packages(\"ggExtra\")\nlibrary(ggExtra)\nlibrary(patchwork)\n#Os voy a matar con este código y esta sintaxis que me hacéis arreglar cada vez\ndf1 <- df %>% dplyr::rename(ámbito = Comunidades.y.Ciudades.Autónomas, tipo = \n                              General..vivienda.nueva.y.de.segunda.mano, Valor = value) %>% filter (tipo == \"General\", Índices.y.tasas == \"Índice\", ámbito == \"Nacional\")\n#rm (list = ls())\ndf1.1 <- df %>% rename(Territorio = Comunidades.y.Ciudades.Autónomas, tipo = General..vivienda.nueva.y.de.segunda.mano, Valor = value)\n\ndf1.2 <- df1.1 %>% mutate(Territorio = case_when( \n  Territorio == \"01 Andalucía\" ~ \"Andalucía\",\n  Territorio == \"02 Aragón\" ~ \"Aragón\",\n  Territorio == \"03 Asturias, Principado de\" ~ \"Asturias, Principado de\",\n  Territorio == \"04 Balears, Illes\" ~ \"Balears, Illes\",\n  Territorio == \"05 Canarias\" ~ \"Canarias\",\n  Territorio == \"06 Cantabria\" ~ \"Cantabria\",\n  Territorio == \"07 Castilla y León\" ~ \"Castilla y León\",\n  Territorio == \"08 Castilla - La Mancha\" ~ \"Castilla-La Mancha\",\n  Territorio == \"09 Cataluña\" ~ \"Cataluña\",\n  Territorio == \"10 Comunitat Valenciana\" ~ \"Comunitat Valenciana\",\n  Territorio == \"11 Extremadura\" ~ \"Extremadura\",\n  Territorio == \"12 Galicia\" ~ \"Galicia\",\n  Territorio == \"13 Madrid, Comunidad de\" ~ \"Madrid, Comunidad de\",\n  Territorio == \"14 Murcia, Región de\" ~ \"Murcia, Región de\",\n  Territorio == \"15 Navarra, Comunidad Foral de\" ~ \"Navarra, Comunidad Foral de\",\n  Territorio == \"16 País Vasco\" ~ \"País Vasco\",\n  Territorio == \"17 Rioja, La\" ~ \"Rioja, La\", \n  TRUE ~ Territorio))\n\ndf3 <- df1.2 %>% filter (tipo == \"General\", Índices.y.tasas == \"Índice\", !(Territorio %in% c(\"Nacional\", \"18 Ceuta\", \"19 Melilla\")))\nprov <- pjpv.curso.R.2022::LAU2_prov_2020_canarias\nccaa <- prov %>%\n  group_by(ine_ccaa, ine_ccaa.n, ine_ccaa.n.pjp) %>%\n  summarise() %>% ungroup()\n\nccaa <- ccaa %>% rename(Territorio = ine_ccaa.n)\ndf4 <- df3 %>% filter(Periodo == \"2023T3\")\ndf5 <- full_join(ccaa, df4, by = \"Territorio\") %>% filter( !(Territorio %in% c(\"Ceuta\", \"Melilla\")))\ndf6 <- df3 %>% \n  filter(Periodo == \"2018T3\")\ndf7 <- full_join(ccaa, df6, by = \"Territorio\") %>% filter( !(Territorio %in% c(\"Ceuta\", \"Melilla\")))\ndf8 <- df3 %>% filter(Periodo == \"2015T3\")\ndf9 <- full_join(ccaa, df8, by = \"Territorio\") %>% filter( !(Territorio %in% c(\"Ceuta\", \"Melilla\")))\ndf10 <- df3 %>% filter(Periodo == \"2011T3\")\ndf11 <- full_join(ccaa, df10, by = \"Territorio\") %>% filter( !(Territorio %in% c(\"Ceuta\", \"Melilla\")))\ndf12 <- df3 %>% filter(Periodo == \"2013T3\")\ndf13 <- full_join(ccaa, df12, by = \"Territorio\") %>% filter( !(Territorio %in% c(\"Ceuta\", \"Melilla\")))\ndf14 <- df3 %>% filter(Periodo == \"2007T3\")\ndf15 <- full_join(ccaa, df14, by = \"Territorio\") %>% filter( !(Territorio %in% c(\"Ceuta\", \"Melilla\")))\n\nlibrary(patchwork)\nescala_limites <- c(90, 190)\n\np4 <- ggplot(df5, aes(fill = Valor)) +\n  geom_sf() +\n  geom_sf_label(aes(label = as.character(Valor)), size = 3, color = \"black\") +\n  scale_fill_viridis_c(guide = \"legend\",limits = escala_limites) +\n  labs(title = \"Precios vivienda CCAA 2023T3 (100 = 2015)\",caption = \"Elaboración propia a partir de datos extraídos de INE\") +\n  theme_void() \n\np7 <- ggplot(df13, aes(fill = Valor)) +\n  geom_sf() +\n  geom_sf_label(aes(label = as.character(Valor)), size = 3, color = \"white\") +\n  scale_fill_viridis_c(guide = \"legend\",limits = escala_limites) +\n  labs(title = \"Precios vivienda CCAA 2013T3 (100 = 2015)\",caption = \"Elaboración propia a partir de datos extraídos de INE\") +\n  theme_void() \n\np9 <- ggplot(df15, aes(fill = Valor)) +\n  geom_sf() +\n  geom_sf_label(aes(label = as.character(Valor)), size = 3, color = \"black\") +\n  scale_fill_viridis_c(guide = \"legend\",limits = escala_limites) +\n  labs(title = \"Precios vivienda CCAA 20071T3 (100 = 2015)\",caption = \"Elaboración propia a partir de datos extraídos de INE\") +\n  theme_void() \n# Combinar los dos gráficos\np9\n\np7\n\np4\n```\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=95%}\n:::\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-6-2.png){fig-align='center' width=95%}\n:::\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-6-3.png){fig-align='center' width=95%}\n:::\n:::\n\n\nEstos mapas de coropletas reflejan los niveles de precios de la vivienda en 6 momentos diferentes del tiempo. El primero es del tercer trimestre del año 2007. En ese momento los precios, como podemos observar, son los más altos. Este es el punto más elevado de la burbuja. Los años siguientes reflejan el pinchazo de la burbuja, con un descenso continuado de los precios hasta 2013. Que es el punto más bajo. Hemos decidido poner el año 2015 por ser el año de la base 100. A partir de ahí, vemos cómo en los años posteriores los precios son ya más elevados que en 2015, y particularmente en 2023, ligeramente por\ndebajo, pero sin haber una burbuja. O, al menos, no parece haberla.\n\nAl ser mapas de coropletas podemos sacar conclusiones acerca de en qué comunidades han aumentado más los precios y por tanto, dónde es más difícil acceder a la vivienda, ceteris paribus. En el último gráfico destacan claramente la Comunidad de Madrid, Cataluña y Baleares. Esto no nos sorprende, tanto la Comunidad de Madrid, como Cataluña son regiones muy dinámicas donde, además, se encuentran las principales ciudades de España. Baleares, por su parte, es una de las regiones más turísticas, donde la oferta de inmuebles tampoco es demasiado elevada. Destacan también en segunda fila País Vasco (región muy dinámica), Andalucía y Canarias (regiones muy turísticas).\n\nTal vez os habéis fijado en que estos mapas no concuerdan exactamente con lo que hemos visto hace dos gráficos (se veía que el nivel general de precios de la vivienda es ahora igual al del punto más alto de la burbuja y, sin embargo, en los mapas parece que en 2007T3 los precios son mucho más elevados que en la actualidad).\n\nEsto se debe a que hay más viviendas allá donde más está subiendo el precio como se observa en el gráfico (que hay que insertar). La explicación de la afirmación anterior que parece a priori contradictoria, es que aunque hay más vivienda en esta zona (oferta elevada), la demanda es todavía más elevada que la oferta.\n\n\n---\n \n# Régimen de viviendas de 16 a 29 años\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#Hogares por regimen de tenencia edad\n#Cargamos liberías\nlibrary(ggplot2)\nlibrary(hrbrthemes)\nlibrary(tidyverse)\nlibrary(pxR)\n\nurl4 <- \"https://www.ine.es/jaxiT3/files/t/es/px/9994.px?nocab=1\"\nac <- read.px(url4)\nwrite.csv(ac, file = \"./datos_pulidos/data_1.csv\", sep = \",\")\nvivienda_edad <- read.csv(\"./datos_pulidos/data_1.csv\")\n\ndd <- vivienda_edad %>%\n  dplyr::rename(regimen = Régimen.de.tenencia.de.la.vivienda.principal, edad = Edad.de.la.persona.de.referencia, sexo = Sexo.de.la.persona.de.referencia) %>%\n  filter(edad == \"De 16 a 29 años\", sexo == \"Ambos sexos\")\n\np30 <- dd %>%\n  ggplot(aes(x = Periodo, y = value, fill = regimen)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  theme_ipsum() +\n  labs(x = \"Año\", y = \"% según régimen de tenencia\", \n       title = \"Régimen de vivienda de 16 a 29 años\",\n       subtitle = \"Datos porcentuales\",\n       caption = \"Elaboración propia a partir de datos del INE\") +\n  scale_fill_manual(values = c(\"#66c2a5\", \"#fc8d62\", \"#8da0cb\", \"#e78ac3\"), \n                    labels = c(\"Alquiler a precios de mercado\", \"Alquiler inferior al precio de mercado\", \"Cesión\", \"Propiedad\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1), \n        plot.caption = element_text(hjust = 0.5),\n        plot.title = element_text(hjust = 0.5, color = \"black\", size = 18, face = \"bold\"),\n        plot.subtitle = element_text(hjust = 0.5, size = 14))\n  \n\np30\n```\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=95%}\n:::\n:::\n\n\nEn este gráfico podemos observar cómo el régimen de vivienda entre los jóvenes ha ido variando a lo largo del tiempo. La mayor sustitución ha sido de régimen de propiedad al de alquiler a precios de mercado. También ha aumentado ligeramente el régimen de cesión, es decir; los jóvenes se han trasladado a opciones más asequibles. Aunque los alquileres también suben en las grandes ciudades, siguen siendo opciones más asumibles que pagar la entrada de la hipoteca y su mensualidad, por no hablar de fórmulas utilizadas como el compartir piso.\n\n---\n\n# Otros gráficos bonitos pero poco útiles sobre el salario\n\n::: {.panel-tabset}\n\n# Rigeline por grupo de edad\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rio)\nlibrary(ggplot2)\nlibrary(ggridges)\n\ndf_edad <- import(\"./datos_pulidos/salario_grupo_edad.csv\")\n\np1<- ggplot(df_edad, aes(x = salario, y = grupo_edad, fill = grupo_edad)) +\n  geom_density_ridges() +\n  theme_ridges() + \n  theme(legend.position = \"none\")\n\np1\n```\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=95%}\n:::\n:::\n\n\n# Barras agrupadas por edad\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rio)\nlibrary(ggplot2)\nlibrary(ggridges)\n\ndf_edad <- import(\"./datos_pulidos/salario_grupo_edad.csv\")\n\ndf_edad_01 <- df_edad |> \n  filter(grupo_edad != \"Total\") |> \n  filter()\n\ndf_edad_01$year <- factor(df_edad_01$year)\n\np2 <- ggplot(df_edad_01, aes(fill = grupo_edad, y = salario, x = year))+\n  geom_bar(position = \"dodge\", stat = \"identity\")+\n  labs(title = \"Salario por grupo de edad\", caption = \"Elaboración propia a partir de datos extraídos de INE\")\n\np2\n```\n\n::: {.cell-output-display}\n![](my_trabajo_BigData_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=95%}\n:::\n:::\n\n\n:::\n\n--- \n\n# Conclusiones:\n\nCon este trabajo hemos podido comprobar la situación precaria en la que se encuentran los jóvenes a la hora de acceder a la vivienda: salarios bajos, tasa de paro muy por encima del resto de las edades, pobreza relativa creciente, niveles de precios de la vivienda astronómicos…\nSi bien no hemos ahondado en las causas de esta situación ni en posibles soluciones, hemos querido al menos señalar de forma clara la situación. Nos afecta directamente y por ello creemos que es algo a lo que, por lo menos, deberíamos prestar atención. \n\nAdemás este tema está de actualidad en la academia por el lanzamiento del libro “La juventud atracada” de Ignacio Conde-Ruiz. En él se repasa lo visto en este trabajo además de la problemática con las pensiones y ahonda más en causas, consecuencias y soluciones. El propio Ignacio dio una charla en la UV hace unas semanas. Os adjuntamos una entrevista que hizo con el también economista Juan Ramón Rallo, en la que habla extensamente de su libro y su contenido.\n\n# Mas información sobre el tema\n\n<center><iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/live/EtIErMd1EYM?si=-LNzHLRcepGHZ-r5\"></iframe></center>\n\n\n",
    "supporting": [
      "my_trabajo_BigData_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<script src=\"site_libs/plotly-binding-4.10.3/plotly.js\"></script>\r\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}